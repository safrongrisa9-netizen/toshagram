<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Онлайн-кликер</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #ffcc00;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .coins {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 8px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
        }

        .coins i {
            color: gold;
        }

        .btn {
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .main-content {
            display: flex;
            width: 100%;
            gap: 20px;
        }

        .left-panel, .right-panel {
            flex: 1;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .center-panel {
            flex: 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .clicker {
            background: linear-gradient(135deg, #8E2DE2, #4A00E0);
            width: 300px;
            height: 300px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            transition: transform 0.1s;
            user-select: none;
        }

        .clicker:active {
            transform: scale(0.95);
        }

        .clicker i {
            font-size: 100px;
            color: white;
        }

        .stats {
            display: flex;
            gap: 15px;
        }

        .stat {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffcc00;
        }

        .upgrades {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .upgrade {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .upgrade-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .upgrade-name {
            font-weight: bold;
            font-size: 18px;
        }

        .upgrade-level {
            background-color: #ffcc00;
            color: #000;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 14px;
        }

        .upgrade-description {
            font-size: 14px;
            color: #ccc;
        }

        .upgrade-cost {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .leaderboard {
            margin-top: 20px;
        }

        .leaderboard-title {
            font-size: 22px;
            margin-bottom: 15px;
            text-align: center;
            color: #ffcc00;
        }

        .leaderboard-list {
            list-style: none;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            background-color: rgba(255, 255, 255, 0.1);
            margin-bottom: 8px;
            border-radius: 8px;
        }

        .leaderboard-position {
            font-weight: bold;
            color: #ffcc00;
        }

        .leaderboard-name {
            flex-grow: 1;
            margin-left: 15px;
        }

        .leaderboard-score {
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .modal-title {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
            color: #ffcc00;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background-color: rgba(255, 255, 255, 0.9);
        }

        .form-actions {
            display: flex;
            justify-content: space-between;
        }

        .click-animation {
            position: absolute;
            pointer-events: none;
            font-size: 24px;
            color: gold;
            animation: floatUp 1s forwards;
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }

        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .upgrades {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">CLICKER MASTER</div>
            <div class="user-info">
                <div class="coins">
                    <i class="fas fa-coins"></i>
                    <span id="coins-count">0</span>
                </div>
                <button id="logout-btn" class="btn">Выйти</button>
            </div>
        </header>

        <div class="main-content">
            <div class="left-panel">
                <h2>Магазин улучшений</h2>
                <div class="upgrades">
                    <div class="upgrade">
                        <div class="upgrade-header">
                            <div class="upgrade-name">Автокликер</div>
                            <div class="upgrade-level">Ур. <span id="autoclicker-level">0</span></div>
                        </div>
                        <div class="upgrade-description">Автоматически кликает каждые 10 секунд</div>
                        <div class="upgrade-cost">
                            <span><i class="fas fa-coins"></i> <span id="autoclicker-cost">50</span></span>
                            <button class="btn buy-btn" data-upgrade="autoclicker">Купить</button>
                        </div>
                    </div>
                    
                    <div class="upgrade">
                        <div class="upgrade-header">
                            <div class="upgrade-name">Усилитель клика</div>
                            <div class="upgrade-level">Ур. <span id="clickpower-level">0</span></div>
                        </div>
                        <div class="upgrade-description">Увеличивает количество монет за клик</div>
                        <div class="upgrade-cost">
                            <span><i class="fas fa-coins"></i> <span id="clickpower-cost">100</span></span>
                            <button class="btn buy-btn" data-upgrade="clickpower">Купить</button>
                        </div>
                    </div>
                    
                    <div class="upgrade">
                        <div class="upgrade-header">
                            <div class="upgrade-name">Удача</div>
                            <div class="upgrade-level">Ур. <span id="luck-level">0</span></div>
                        </div>
                        <div class="upgrade-description">Шанс получить х2 монеты за клик</div>
                        <div class="upgrade-cost">
                            <span><i class="fas fa-coins"></i> <span id="luck-cost">200</span></span>
                            <button class="btn buy-btn" data-upgrade="luck">Купить</button>
                        </div>
                    </div>
                    
                    <div class="upgrade">
                        <div class="upgrade-header">
                            <div class="upgrade-name">Критический удар</div>
                            <div class="upgrade-level">Ур. <span id="critical-level">0</span></div>
                        </div>
                        <div class="upgrade-description">Шанс нанести критический удар (x5)</div>
                        <div class="upgrade-cost">
                            <span><i class="fas fa-coins"></i> <span id="critical-cost">300</span></span>
                            <button class="btn buy-btn" data-upgrade="critical">Купить</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="center-panel">
                <div class="clicker" id="clicker">
                    <i class="fas fa-hand-pointer"></i>
                </div>
                <div class="stats">
                    <div class="stat">
                        <div>Монет за клик</div>
                        <div class="stat-value" id="coins-per-click">1</div>
                    </div>
                    <div class="stat">
                        <div>Всего кликов</div>
                        <div class="stat-value" id="total-clicks">0</div>
                    </div>
                </div>
            </div>
            
            <div class="right-panel">
                <h2>Таблица лидеров</h2>
                <div class="leaderboard">
                    <div class="leaderboard-title">Топ-10 игроков</div>
                    <ul class="leaderboard-list" id="leaderboard">
                        <!-- Leaderboard will be populated by JavaScript -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal" id="login-modal">
        <div class="modal-content">
            <h2 class="modal-title">Вход</h2>
            <div class="form-group">
                <label for="login-username">Имя пользователя</label>
                <input type="text" id="login-username" placeholder="Введите имя пользователя">
            </div>
            <div class="form-group">
                <label for="login-password">Пароль</label>
                <input type="password" id="login-password" placeholder="Введите пароль">
            </div>
            <div class="form-actions">
                <button class="btn" id="login-btn">Войти</button>
                <button class="btn" id="show-register">Регистрация</button>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="register-modal">
        <div class="modal-content">
            <h2 class="modal-title">Регистрация</h2>
            <div class="form-group">
                <label for="register-username">Имя пользователя</label>
                <input type="text" id="register-username" placeholder="Придумайте имя пользователя">
            </div>
            <div class="form-group">
                <label for="register-password">Пароль</label>
                <input type="password" id="register-password" placeholder="Придумайте пароль">
            </div>
            <div class="form-actions">
                <button class="btn" id="register-btn">Зарегистрироваться</button>
                <button class="btn" id="show-login">Назад к входу</button>
            </div>
        </div>
    </div>

    <script>
        // Основные переменные
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('clickerUsers')) || {};
        let coins = 0;
        let totalClicks = 0;
        let coinsPerClick = 1;
        let upgrades = {
            autoclicker: { level: 0, cost: 50 },
            clickpower: { level: 0, cost: 100 },
            luck: { level: 0, cost: 200 },
            critical: { level: 0, cost: 300 }
        };
        let autoClickInterval = null;

        // DOM элементы
        const clicker = document.getElementById('clicker');
        const coinsCountElement = document.getElementById('coins-count');
        const coinsPerClickElement = document.getElementById('coins-per-click');
        const totalClicksElement = document.getElementById('total-clicks');
        const leaderboardElement = document.getElementById('leaderboard');
        
        // Модальные окна
        const loginModal = document.getElementById('login-modal');
        const registerModal = document.getElementById('register-modal');

        // Инициализация
        function init() {
            loadLeaderboard();
            checkAuth();
            
            // Обработчики событий
            clicker.addEventListener('click', handleClick);
            document.querySelectorAll('.buy-btn').forEach(btn => {
                btn.addEventListener('click', handleBuyUpgrade);
            });
            
            document.getElementById('logout-btn').addEventListener('click', handleLogout);
            document.getElementById('login-btn').addEventListener('click', handleLogin);
            document.getElementById('register-btn').addEventListener('click', handleRegister);
            document.getElementById('show-register').addEventListener('click', showRegister);
            document.getElementById('show-login').addEventListener('click', showLogin);
        }

        // Проверка авторизации
        function checkAuth() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser && users[savedUser]) {
                currentUser = savedUser;
                loadUserData();
                updateUI();
            } else {
                showLogin();
            }
        }

        // Загрузка данных пользователя
        function loadUserData() {
            if (users[currentUser]) {
                coins = users[currentUser].coins || 0;
                totalClicks = users[currentUser].totalClicks || 0;
                coinsPerClick = users[currentUser].coinsPerClick || 1;
                upgrades = users[currentUser].upgrades || upgrades;
                
                // Запуск автокликера, если есть
                if (upgrades.autoclicker.level > 0) {
                    startAutoClicker();
                }
            }
        }

        // Сохранение данных пользователя
        function saveUserData() {
            if (currentUser) {
                users[currentUser] = {
                    coins,
                    totalClicks,
                    coinsPerClick,
                    upgrades
                };
                localStorage.setItem('clickerUsers', JSON.stringify(users));
                updateLeaderboard();
            }
        }

        // Обработка клика
        function handleClick(e) {
            // Определяем, был ли критический удар
            let criticalHit = false;
            if (upgrades.critical.level > 0 && Math.random() < upgrades.critical.level * 0.05) {
                criticalHit = true;
            }
            
            // Определяем, был ли удачный клик
            let luckyClick = false;
            if (upgrades.luck.level > 0 && Math.random() < upgrades.luck.level * 0.03) {
                luckyClick = true;
            }
            
            // Вычисляем количество монет за клик
            let clickValue = coinsPerClick;
            if (criticalHit) clickValue *= 5;
            if (luckyClick) clickValue *= 2;
            
            // Добавляем монеты
            coins += clickValue;
            totalClicks++;
            
            // Создаем анимацию клика
            createClickAnimation(e, clickValue, criticalHit, luckyClick);
            
            // Обновляем UI и сохраняем данные
            updateUI();
            saveUserData();
        }

        // Создание анимации клика
        function createClickAnimation(e, value, isCritical, isLucky) {
            const anim = document.createElement('div');
            anim.className = 'click-animation';
            anim.textContent = `+${value}`;
            
            if (isCritical) {
                anim.style.color = '#ff0000';
                anim.style.fontSize = '28px';
                anim.style.fontWeight = 'bold';
            } else if (isLucky) {
                anim.style.color = '#00ff00';
            }
            
            document.body.appendChild(anim);
            
            // Позиционируем анимацию
            const rect = clicker.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            anim.style.left = `${rect.left + x}px`;
            anim.style.top = `${rect.top + y}px`;
            
            // Удаляем анимацию после завершения
            setTimeout(() => {
                anim.remove();
            }, 1000);
        }

        // Покупка улучшения
        function handleBuyUpgrade(e) {
            const upgradeType = e.target.dataset.upgrade;
            const upgrade = upgrades[upgradeType];
            
            if (coins >= upgrade.cost) {
                coins -= upgrade.cost;
                upgrade.level++;
                upgrade.cost = Math.floor(upgrade.cost * 1.5);
                
                // Применяем эффекты улучшений
                applyUpgradeEffects(upgradeType);
                
                // Обновляем UI и сохраняем данные
                updateUI();
                saveUserData();
                
                // Если купили автокликер, запускаем его
                if (upgradeType === 'autoclicker' && upgrade.level === 1) {
                    startAutoClicker();
                }
            } else {
                alert('Недостаточно монет!');
            }
        }

        // Применение эффектов улучшений
        function applyUpgradeEffects(type) {
            switch(type) {
                case 'clickpower':
                    coinsPerClick = 1 + upgrades.clickpower.level;
                    break;
                case 'autoclicker':
                    // Уже обрабатывается при покупке
                    break;
                // Для luck и critical не нужно обновлять значения в реальном времени
            }
        }

        // Запуск автокликера
        function startAutoClicker() {
            if (autoClickInterval) {
                clearInterval(autoClickInterval);
            }
            
            const interval = 10000 / (1 + upgrades.autoclicker.level * 0.5);
            autoClickInterval = setInterval(() => {
                coins += coinsPerClick * (0.5 + upgrades.autoclicker.level * 0.1);
                totalClicks++;
                updateUI();
                saveUserData();
            }, interval);
        }

        // Обновление интерфейса
        function updateUI() {
            coinsCountElement.textContent = coins;
            coinsPerClickElement.textContent = coinsPerClick;
            totalClicksElement.textContent = totalClicks;
            
            // Обновляем информацию об улучшениях
            for (const [key, upgrade] of Object.entries(upgrades)) {
                document.getElementById(`${key}-level`).textContent = upgrade.level;
                document.getElementById(`${key}-cost`).textContent = upgrade.cost;
            }
        }

        // Загрузка таблицы лидеров
        function loadLeaderboard() {
            const leaderboard = getLeaderboard();
            leaderboardElement.innerHTML = '';
            
            leaderboard.forEach((user, index) => {
                const li = document.createElement('li');
                li.className = 'leaderboard-item';
                
                li.innerHTML = `
                    <span class="leaderboard-position">${index + 1}</span>
                    <span class="leaderboard-name">${user.username}</span>
                    <span class="leaderboard-score">${user.coins} <i class="fas fa-coins"></i></span>
                `;
                
                if (user.username === currentUser) {
                    li.style.backgroundColor = 'rgba(255, 204, 0, 0.2)';
                }
                
                leaderboardElement.appendChild(li);
            });
        }

        // Получение таблицы лидеров
        function getLeaderboard() {
            const leaderboard = [];
            
            for (const [username, data] of Object.entries(users)) {
                leaderboard.push({
                    username,
                    coins: data.coins || 0
                });
            }
            
            return leaderboard.sort((a, b) => b.coins - a.coins).slice(0, 10);
        }

        // Обновление таблицы лидеров
        function updateLeaderboard() {
            loadLeaderboard();
        }

        // Вход
        function handleLogin() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            
            if (!username || !password) {
                alert('Заполните все поля!');
                return;
            }
            
            if (users[username] && users[username].password === password) {
                currentUser = username;
                localStorage.setItem('currentUser', username);
                loadUserData();
                updateUI();
                hideModals();
            } else {
                alert('Неверное имя пользователя или пароль!');
            }
        }

        // Регистрация
        function handleRegister() {
            const username = document.getElementById('register-username').value;
            const password = document.getElementById('register-password').value;
            
            if (!username || !password) {
                alert('Заполните все поля!');
                return;
            }
            
            if (users[username]) {
                alert('Пользователь с таким именем уже существует!');
                return;
            }
            
            users[username] = {
                password,
                coins: 0,
                totalClicks: 0,
                coinsPerClick: 1,
                upgrades: {
                    autoclicker: { level: 0, cost: 50 },
                    clickpower: { level: 0, cost: 100 },
                    luck: { level: 0, cost: 200 },
                    critical: { level: 0, cost: 300 }
                }
            };
            
            localStorage.setItem('clickerUsers', JSON.stringify(users));
            
            currentUser = username;
            localStorage.setItem('currentUser', username);
            loadUserData();
            updateUI();
            hideModals();
            
            alert('Регистрация прошла успешно!');
        }

        // Выход
        function handleLogout() {
            saveUserData();
            currentUser = null;
            localStorage.removeItem('currentUser');
            
            if (autoClickInterval) {
                clearInterval(autoClickInterval);
                autoClickInterval = null;
            }
            
            showLogin();
        }

        // Показать модальное окно входа
        function showLogin() {
            loginModal.style.display = 'flex';
            registerModal.style.display = 'none';
        }

        // Показать модальное окно регистрации
        function showRegister() {
            loginModal.style.display = 'none';
            registerModal.style.display = 'flex';
        }

        // Скрыть все модальные окна
        function hideModals() {
            loginModal.style.display = 'none';
            registerModal.style.display = 'none';
        }

        // Запуск приложения
        window.addEventListener('load', init);
        
        // Сохранение данных при закрытии страницы
        window.addEventListener('beforeunload', () => {
            if (currentUser) {
                saveUserData();
            }
        });
    </script>
</body>
</html>
